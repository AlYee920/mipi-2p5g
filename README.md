# mipi-2p5g
EFX MIPI TX 2.5g verification using Ti180M484 as TX and Au25p as RX

## Instruction:

1.	Use Efinity to program Ti180M484 with Ti180_mipi_RGB888_2k.bit bitstream located in /mipi_bitstream folder.
2.	Connect Au25p JTAG interface via Alinx Cable
3.	Launch Vivado 2023.2 and open hardware manager. Program the device using the bitstream in /mipi_bitstream folder
4.	Connect the SZG_EFX Adapter board to P3 port on Ti180M484.
 
 ![Picture1](https://github.com/AlYee920/mipi-2p5g/assets/159541045/827e09e4-e470-42f9-8265-f6ef143d84d8)
 
5.	Connect QSE-QTE Cable between adapter board and Port C of Au25p

 ![Picture2](https://github.com/AlYee920/mipi-2p5g/assets/159541045/9cfc3a0b-49c8-40da-9a1e-8658f37a7c76)
 
6.	In Vivado debugger, there is 3 hw_ila and 1 hw_vio cores. 
    a.	hw_ila_1 monitors signals from error checker and controller.
    b.	hw_ila_2 monitors data signal from PPI interface for each lane.
    c.	hw_ila_3 monitors stop state signal for each lane.
    d.	hw_vio controls the reset signal for the system.
7.	Configure the trigger in Vivado logic analyser.
8.	Reset the RX by toggling the vio in vivado. (active high reset is asserted when the vio = 1)

 ![Picture3](https://github.com/AlYee920/mipi-2p5g/assets/159541045/0b1d7864-3f26-49ab-b37f-1a5c02bf7187)
 
9.	Reset the TX by pressing SW3 on Ti180M484 dev board.

 ![Picture4](https://github.com/AlYee920/mipi-2p5g/assets/159541045/c58d1124-fdc0-4844-8a7a-f328fc67677e)
 
10.	Run the trigger on Vivado to begin capturing.

 ![Picture5](https://github.com/AlYee920/mipi-2p5g/assets/159541045/508e4063-f3d3-494c-a6f9-2821b425e2d3)

11.	Press SW4 on Ti180M484 to start the packet transfer.

 ![Picture6](https://github.com/AlYee920/mipi-2p5g/assets/159541045/bffa4571-c1fe-4df9-9ac8-7d018c6899b6)

13.	Observed the obtained waveform from the LA in Vivado.
14.	The value of status register can be accessed using TCL command.
15.	Open the MIPI_CSI_2p5g_verification.xlsx excel sheet.
16.	Copy the contents from TCL COMMAND column and paste it in the TCL console in vivado.

 ![Picture7](https://github.com/AlYee920/mipi-2p5g/assets/159541045/b937293c-cde0-4e3b-a97c-585be888d829)
 ![Picture8](https://github.com/AlYee920/mipi-2p5g/assets/159541045/de8417bd-17b3-48a9-a950-07067e7798d7)

17.	Discard the first line and copy the rest of the output into the OUTPUT column in the excel sheet.
 ![Picture9](https://github.com/AlYee920/mipi-2p5g/assets/159541045/5469eadc-a726-45e2-bde3-20f58fcd6f69)
 ![Picture10](https://github.com/AlYee920/mipi-2p5g/assets/159541045/f4e69256-e6a9-46d5-ae8d-cb1a6a7bc970)
18.	The information of the status register is extracted in the table to the right side of the excel sheet.
 ![Picture11](https://github.com/AlYee920/mipi-2p5g/assets/159541045/00c1224b-d3e3-4773-b253-7d567beca166)


Note:
- Do not connect the QSE-QTE cable during power up of the board.
- MIPI-RX (Au25p) is required to be reset first before resetting MIPI TX (Ti180) to ensure successful rxbyteclk recovery.

## Measuring the RXBYTECLKHS
To show that the mipi subsystem is running at 2.5 G, the RX byte clock can be probe using the oscilloscope. According to MIPI CSI2 specification, the byte clock is required to run at 1/8 of the line rate. Rxbyteclkhs is the generated by deskewing the received txbyteclkhs from the clock lane. So, for line rate of 2.5G, the expected frequency of byteclkhs is 2500/8= 312.5MHz. 

 ![Picture12](https://github.com/AlYee920/mipi-2p5g/assets/159541045/28643d2e-6a73-4896-a255-7b9a058e410b)
 ![Picture13](https://github.com/AlYee920/mipi-2p5g/assets/159541045/29403b4b-70bf-45b0-91a5-0beb7a460d51)

1.	To measure the rxbyteclkhs, connect the SZG-EFX adapter board to MIPI_SMA card

 ![Picture14](https://github.com/AlYee920/mipi-2p5g/assets/159541045/389b20d0-3f2a-4056-a742-7264e08fd310)
 ![Picture15](https://github.com/AlYee920/mipi-2p5g/assets/159541045/8681c09b-ce04-4c32-8e9b-8211398be341)

2.	Connect the SMA card to PORT A of Au25p

 ![Picture16](https://github.com/AlYee920/mipi-2p5g/assets/159541045/0b28927c-ae03-453b-a5e9-510dca753d03)

3.	Connect SMA cable to J24 on the SMA Card.

 ![Picture17](https://github.com/AlYee920/mipi-2p5g/assets/159541045/b5a74fb4-2afd-4f21-ab1c-e71743e8a739)

4.	Connect the SMA cable to the scope.

 ![Picture18](https://github.com/AlYee920/mipi-2p5g/assets/159541045/011499b0-ba99-4972-b937-951e134c6b80)


